# Audio Testing Library - README

## Overview

This directory contains various shell scripts used for audio diagnostics and troubleshooting on Android and Linux systems. These scripts are designed to gather detailed information about audio hardware and system configurations, helping users debug and optimize their audio setup.

## Directory Structure
```
audio_testing/ 
    |— alsa-dac-profile.sh              # Displays hardware/software configuration for ALSA DACs 
    |— audio-conf-src.sh                # Retrieves audio policy configuration details 
    |— audioTestlib.sh                  # Main script to execute all or specific tests 
    |— dmesg-audio.sh                   # Captures audio-related logs from the kernel ring buffer 
    |— dumpsys-audio.sh                 # Captures filtered audio-related dumpsys information 
    |— dumpsys-bt.sh                    # Filters and captures Bluetooth-specific audio details
    |— readme.md                        # Documentation file
```

## Scripts Description

### 1. `alsa-dac-profile.sh`
This script displays hardware and software configurations for ALSA DACs, including details for USB DACs and Bluetooth/speaker setups.

### 2. `audio-conf-src.sh`
Retrieves audio policy configuration information to diagnose and verify system audio policies.

### 3. `audioTestlib.sh`
The main testing script that allows users to execute a suite of diagnostics. Includes options for running specific tests or all available scripts in one go.

### 4. `dmesg-audio.sh`
Captures and filters audio-related logs from the kernel ring buffer (`dmesg`), providing insights into low-level system behavior and potential hardware issues.

### 5. `dumpsys-audio.sh`
Filters and captures audio-related details from Android’s `dumpsys` tool for system-level debugging and analysis.

### 6. `dumpsys-bt.sh`
Extracts Bluetooth audio information using Android’s `dumpsys` tool. Useful for debugging Bluetooth audio profiles and connected devices.


## Features
- **Device-Specific Configuration**: Displays device-specific hardware and software capabilities/parameters.
  - **Card0**: Bluetooth/Speaker. Provides details such as `id`, `aoc_audio_state`, and `aoc_aocdump_state`.
  - **Card1**: USB DAC. Displays information such as `id`, `stream`, `usbbus`, `usbid`, and `usbmixer`.
- **Troubleshooting and Debugging**: Uses various system logs for gathering information and debugging.
- **Filtered and Readable Output**: The output is currently a single file that is filtered, formatted, and modular.

## Usage Requirements
1. **Root Access**: The scripts require root privileges to modify system-level audio settings.
2. **Executable Permissions**: Ensure all scripts are executable:
   ```sh
   chmod +x *.sh
   ```
   
### Running the Main Script
```
sudo sh audioTestlib.sh [options]
```

### Available Options
You can use the following options to choose which scripts to run:

- `-a`: Run `alsa-dac-profile.sh` to gather ALSA hardware parameters for Bluetooth, speakers, and USB DACs.
- `-g`: Run `audio-conf-src.sh` to gather audio policy configurations.
- `-b`: Run `dumpsys-bt.sh` to filter Bluetooth audio information.
- `-d`: Run `dumpsys-audio.sh` to capture filtered audio dumpsys data.
- `-m`: Run `dmesg-audio.sh` to capture filtered kernel audio logs.
- `-t`: Run `tinymix.sh` to capture mixer settings for the connected device.
- `-A` or `--all`: Run all the above scripts.

If no options are specified, the script defaults to running all scripts.

You can combine multiple options to run several scripts at once. For example:
```
sudo sh audioTestlib.sh -a -g -b
```

## Example Output
The output from each script is saved to a log file named in the format `audioTestlib_YYYYMMDDHHMMSS.log`, where the timestamp indicates the time the script was run.

Each section in the log file is clearly marked with a green, colored headers to make it easy to locate information.


## Troubleshooting
- **Permission Denied**: If you encounter "permission denied" errors, ensure that you have root access and that the scripts have executable permissions (`chmod +x script_name.sh`).
- **Unexpected Behavior**: Review the log files generated by the scripts for insights into potential problems.

## Contributing
Feel free to contribute to this project by adding more scripts or enhancing existing functionality. Please ensure all contributions are well-documented and thoroughly tested.

## License
This project is licensed under the MIT License. Feel free to modify and use it according to your needs.

## Contact
For questions or support, please reach out to github.com/JLukassen.
